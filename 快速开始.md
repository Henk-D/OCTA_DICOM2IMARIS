# Zeiss OCTA Converter - 快速开始指南

## 🚀 三种使用方式

### 方式1：图形界面（推荐新手）
双击运行 `启动GUI.bat`
- ✅ 可视化界面
- ✅ 一键选择数据
- ✅ 实时查看转换日志
- ✅ 自动打开输出文件夹

### 方式2：命令行
```bash
python Zeiss_OCTA_Converter.py [文件夹名]
```
例如：
```bash
python Zeiss_OCTA_Converter.py HenkE433
```

### 方式3：批处理脚本
双击运行 `转换OCTA数据.bat`，然后输入文件夹名

## 📦 环境安装

### 使用 Conda/Mamba（推荐）

1. **安装 Miniforge** (如果还没有安装)
   - 下载：https://github.com/conda-forge/miniforge
   - 安装后重启终端

2. **创建环境**
   ```bash
   # 双击运行
   setup_environment.bat
   
   # 或手动运行
   mamba env create -f environment.yml
   ```

3. **激活环境**
   ```bash
   mamba activate octa-converter
   ```

4. **运行程序**
   ```bash
   python Zeiss_OCTA_Converter.py HenkE433
   # 或
   python OCTA_Converter_GUI.py
   ```

### 使用 Pip

```bash
pip install -r requirements.txt
```

## 📂 输出文件

每次转换生成5个文件在 `Results/[文件夹名]/`：

| 文件 | 用途 | 大小 |
|------|------|------|
| `OCTA_xxx.tif` | Imaris 3D可视化 | ~59 MB |
| `OCTA_xxx.nii.gz` | 医学影像软件 (ITK-SNAP, 3D Slicer) | ~38 MB |
| `OCTA_xxx.npy` | Python/NumPy分析 | ~59 MB |
| `OCTA_xxx_metadata.json` | 元数据（体素大小等） | ~1 KB |
| `OCTA_xxx_Preview.png` | MIP预览图 | ~2 MB |

## 🔧 支持的分辨率

- 245×245×1024 (3×3mm)
- 320×320×1024 (4×4mm)
- 400×400×1024 (5×5mm)
- 490×490×1024 (6×6mm)
- 640×640×1024 (8×8mm)
- 980×980×1024 (12×12mm)
- 自动适应其他分辨率

## 📖 详细文档

- 完整使用说明：[使用说明.md](使用说明.md)
- 技术总结：[项目完成总结.md](项目完成总结.md)
- English README: [README_EN.md](README_EN.md)

## ⚡ 常见问题

**Q: GUI无法启动？**
A: 确保安装了所有依赖：`pip install -r requirements.txt`

**Q: 找不到数据文件夹？**
A: 数据应放在 `DataFiles/[文件夹名]/` 或 `../HenkOCTA_DataFiles/[文件夹名]/`

**Q: 转换失败？**
A: 检查：
1. DICOM文件是否来自Zeiss Cirrus HD-OCT
2. 是否安装了 pylibjpeg-openjpeg（JPEG 2000解码器）
3. 查看转换日志中的详细错误信息

**Q: 体素大小不正确？**
A: 查看 `metadata.json` 确认，如需调整，修改脚本中的 `calculate_voxel_size()` 函数

## 🎯 下一步

- 在 Imaris 中打开 `.tif` 文件
- 在 ITK-SNAP 中打开 `.nii.gz` 文件
- 使用 Python/NumPy 分析 `.npy` 文件
- 查看 `_Preview.png` 确认血管结构

---

**项目地址**: https://github.com/Henk-D/OCTA_DICOM2IMARIS
